## (1) 동시에 같은 `DB Table row` 를 업데이트 하는 상황을 방어하기 위해 어떻게 개발하실 건지 설명해주세요.

질문과 같은 상황을 방어하기 위해 락킹, 타임스탬프, 낙관적 검증, MVCC과 같은 동시성 제어 기법을 사용하여 개발할 것입니다.  
  
  
  
락킹(Locking) 은 트랜잭션이 사용하는 데이터에 잠금(Lock)을 설정하게 되면 해제(Unlock)할 때까지 다른 트랜잭션은 해당 데이터에 수정, 접근, 삭제가 불가능한 `상호 배제 기능`을 제공하는 기법입니다.  
연산 종류로 `공유 잠금`(Shared Lcok)은 해당 트랜잭션 또는 다른 트랜잭션은 데이터 항목에 대해 읽기만 가능하여  
`전용 잠금`(Exclusive Lock)은 해당 트랜잭션은 데이터 항목에 대해 읽기, 수정이 모두 가능하지만 다른 트랜잭션은 읽기, 쓰기 모두 할 수 없습니다.  


타임스탬프(Timestamp)는 DBMS에서 지정하는 고유번호인 타임스탬프를 트랜잭션에 부여하여 트랜잭션간의 순서를 미리 정하는 기법입니다.
타임스탬프 종류로 `시스템 클럭`(System Clock)은 트랜잭션이 시스템에 들어왔을 때 시스템 시간을 적용하는 것이며  
`논리적 계수기`(Logical Count)는 트랜잭션이 발생할 때마다 카운트를 하나씩 증가하는 것입니다.  


낙관적 검증은 트랜잭션 수행 중에는 데이터 항목들이 지역 사본에 대해서만 갱신이 이루어지고 트랜잭션 종료후에는 동시성을 위한 트랜잭션 직렬화 검증 후 DB에 반영하는 기법입니다.
낙관적 검증 수행 단계로 먼저 `판독단계`(Read Phase)에서 트랜잭션 작업 구역에 지역 사본으로 만들어 읽기와 갱신을 수행하고  
`확인단계`(Vaildation Phase)에서 DB에 반영하기 전 충돌 직렬 가능성을 검사합니다.  
마지막으로 `기록단계`(Write Phase)에서는 확인단계를 통과한 트랜잭션의 실행결과를 실제 DB에 반영하고 그렇지 않으면 트랜잭션을 취소하고 다시 재시작합니다.  


다중버전 병행제어 기법(MVCC : Multi Version Concurrency Control)은 `동시 접근을 허용하는 DB에서 동시성을 제어`하기 위해 사용되며 트랜잭션의 타임스탬프와 접근하려는 데이터의 여러 버전의 타임스탬프를 비교 후 직렬 가능성이 보장되는 적절한 버전을 선택해 접근하도록 하는 기법입니다.  

다음은 동시성제어 기법들의 장단점 표입니다.  


| 동시성제어 기법 | 장점                                                         | 단점                                                         |
| --------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 락킹            | 알고리즘이 간단<br />데이터 오류 가능성 예방가능             | Deadlcok발생<br />Lock대기시간 발생                          |
| 타임스탬프      | Deadlock발생 없음<br />트랜잭션 대기시간 없음                | Rollback 발생확률이 높다<br />cascading Rollback 가능성 있음 |
| 낙관적 검증     | 동시 처리<br />트랜잭션 대기시간 없음                        | 장기 트랜잭션 철회시 자원이 낭비                             |
| MVCC            | 잠금을 사용하지 않아 <br />일반 RDBMS보다 빠르게 작동<br />일관성, 동시성 모두 해결 | Undo 블록 I/O에 따른 오버헤드 발생<br />사용하지 않는 데이터가 쌓여 정리 시스템 필요 |


